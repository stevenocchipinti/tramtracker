#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path('../../lib', __FILE__)
require 'tramtracker'
require 'formatters'

require 'optparse'

optparse = OptionParser.new do |opts|
  opts.banner = "Usage: tramtracker [options] <stop-id>"

  # opts.on('-p', '--poll', "Poll every 15 seconds") do
  #   options[:interval] = 15
  #   options[:max_iterations] = 60
  # end

  opts.on('-h', '--help', 'Display this screen') do
    puts opts
    exit
  end
end
optparse.parse!

id = ARGV[0]
dotfile = "#{ENV['HOME']}/.tramtracker"
id ||= File.read(dotfile) if File.exists?(dotfile)

unless id
  puts optparse
  exit 1
end


tramtracker = Tramtracker.new(id)
formatter = Formatters::PrintFormatter.new(tramtracker)

formatter.report
